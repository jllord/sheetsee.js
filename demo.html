<html>
  <head>
    <title>Yo, yo, yo!</title>
    <script type="text/javascript" src="js/ICanHaz.js"></script> 
    <script src='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.js'></script>
    <script src='js/jquery.js '></script>
    <script type="text/javascript" src='js/d3.js'></script>
    <script type="text/javascript" src='js/tabletop.js'></script>
    <script type="text/javascript" src='js/sheetsee.js'></script>
    <link rel="shortcut icon" href="https://raw.github.com/jllord/sheetsee-cache/master/favico.png"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.css' rel='stylesheet' />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,600|Merriweather:400,700' rel='stylesheet' />
    <link rel="stylesheet" media="screen" type="text/css" href="css/style.css"> 
    <link rel="stylesheet" media="screen" type="text/css" href="css/site.css"> 
  </head>

<body>
  <div id="menu"><ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#shortsweet">Short + Sweet</a></li>
    <li><a href="#possibilities">Possibilities + Examples</a></li>
    <li><a href="#getstarted">Getting Started</a></li>
    <li><a href="#workdata">Working with the Data</a></li>
    <li><a href="#makemap">Make a Map</a></li>
    <li><a href="#maketable">Make a Table</a></li>
    <li><a href="#makechart">Make a Chart</a></li>
    <li><a href="http://www.github.com/jllord/sheetsee.js" target="_blank" class="a2">Source on GitHub</a></li>
    <li><a href="http://www.twitter.com/jllord" target="_blank" class="a2">I'm @jllord</a></li>
  </div>

  <div id="wrapper">
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/sheetsee-03.png" alt="sheetsee"></p>
    <h1 id="intro">Sheetsee.js</h1>
      <p>Sheetsee.js is a JavaScript library, or box of goodies, if you will, that makes it easy to use a Google Spreadsheet as the database feeding the tables, charts and maps on a website. Once set up, any changes to the spreadsheet will auto-saved by Google and be live on your site when a visitor refreshes the page.</p>
      <p>Using Google Spreadsheets as the backend database is awesome because it is easy to use, share and collaborate with.</p>
      <p>To use sheetsee.js you&#39;ll definitely need to know HTML, CSS and know JavaScript or be not afraid of it and just type what these docs tell you to type. Also, see <a href="http://www.jsforcats.com">JavaScript for Cats</a>, <a href="http://eloquentjavascript.net/">Eloquent JavaScript</a> or <a href="https://developer.mozilla.org/en-US/docs/JavaScript">Mozilla&#39;s Developer Network</a>.</p>

    <h3>Dependencies</h3>
      <p>Sheetsee.js depends on a few other awesome JavaScript libraries to make all this happen. First, <a href="http://builtbybalance.com/Tabletop/">Tabletop.js</a> gets the data from the Google Spreadsheet and makes it nice. Once you have your data Sheetsee.js makes it easy to set up tables or templates with <a href="http://icanhazjs.com/">IChanHas.js</a> (built on <a href="http://mustache.github.io/">mustache.js</a>), maps with <a href="http://mapbox.com/mapbox.js/example/v1.0.0/">Mapbox.js</a>, and charts with <a href="http://d3js.org/">d3.js</a>. And <a href="http://jquery.com/">jQuery</a> of course powers most of the interactions. It also has many sorting and filtering functions built in so that you can display different parts of your data if you want. Each of these are explained in more detail below.</p>

    <h3>CSS</h3>
      <p>Sheetsee.js comes with a bare minimum stylesheet. This way you can customize your site to look the way you want to it or to match an existing site&#39;s design.</p>

    <h3>Client-side or Server-side</h3>
      <p>Sheetsee.js comes in two flavors, client-side (this repo)</a> and server-side <a href="http://github.com/sheetsee-cache">(sheetsee-cache)</a>. The client-side is the most approachable and straightforward, you just include sheetsee.js and the dependencies on your page and use sheetsee.js as normal.</p>
      <p>The server-side version is built with <a href="http://www.nodejs.org">Node.js</a> and you&#39;ll need to understand Node and be publishing to a server that runs Node.js apps. This version saves the data on the server so that the browser doesn&#39;t have to fetch from Google at every request, which can sometimes be slow. You can set when the cache expires. It also allows for offline development, huzzah!</p>

    <div class="ssExample">
      <h2 id="shortsweet">The Short &amp; Sweet</h2>
        <ol>
          <li>Link to Sheetsee.js and dependencies in your HTML header.</li>
          <li>Create a place holder <code data-language="javascript">&lt;div&gt;</code> in your HTML for any chart, map or table you want to have.</li>
          <li>Create templates for tables in <code data-language="javascript">&lt;script&gt;</code> tags.</li>
          <li>Create a script tag that waits for the document to load and then executes any of the map, chart or tables you&#39;ve specified in it.</li>
          <li>Set it and forget. Now all you need to do is edit the spreadsheet and visitors will get the latest information everytime they load the page.</li>
        </ol>
    </div>

  <h2>Bare Minimum Setup</h2>
    <p>Ignoring some HTML things to conserve space, you get the point. This gives you a page with a map of your spreadsheets points.</p>
<pre><code data-language="HTML">&lt;html&gt;
    &lt;head&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;js/ICanHaz.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;js/d3.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;js/sheetsee.js&quot;&gt;&lt;/script&gt;
        &lt;link href=&#39;http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.css&#39; rel=&#39;stylesheet&#39; /&gt;
    &lt;/head&gt;
    &lt;style&gt; #map {height: 600px; width: 600px;} &lt;/style&gt;
    &lt;body&gt;
    &lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
      optionsJSON = ["something", "something"]
        var geoJSON = Sheetsee.createGeoJSON(gData, featureElements)
        var map = Sheetsee.loadMap(&quot;map&quot;)
        Sheetsee.addTileLayer(map, &#39;examples.map-20v6611k&#39;)
        var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map)
    &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>

  <h2 id="possibilities">Awesome Possibilities</h2>
      <ol>
      <li>Small newsrooms with data for stories but small dev teams.</li>
      <li>Friends or groups collaborating on data for a website/project.</li>
      <li>Using <a href="http://www.ifttt.com">iftt.com</a> to auto populate spreadsheets which are hooked to a website with Sheetsee.js.</li>
    </ol>

  <h2>Examples</h2>
    <ol>
      <li><a href="http://jlord.github.io/hack-spots" target="_blank">Hack Spots</a></li>
      <li>Pennies</li>
      <li><a href="https://twitter.com/jugglingnutcase">James Sconfitto</a> make a <a href="https://github.com/jugglingnutcase/katiejamie">map of his relationship</a> with his wife &lt;3</li>
    </ol>

  <h2 id="getstarted">Getting Started</h2>
    <p>This bit is the same for both client-side and server-side versions.</p>
  <h3>Your Data</h3>
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/spreadsheettodata.png" alt="sheetsee"></p>
    <p>Your Google Spreadsheet should be set up with row one as your column headers. Row two and beyond should be your data.  Each header and row becomes an oject in the final array that Tabletop.js delivers of your data.</p>
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/nonos.png" alt="sheetsee"></p>
    <p>There shouldn&#39;t be any breaks or horizontal organization in the spreadsheet. But, feel free to format the style of your spreadsheet as you wish; borders, fonts and colors and such do not transfer or affect your data exporting.</p>
    <pre><code data-language="javascript">[{&quot;name&quot;:&quot;Coco&quot;,&quot;breed&quot;:&quot;Teacup Maltese&quot;,&quot;kind&quot;:&quot;Dog&quot;,&quot;cuddlability&quot;:&quot;5&quot;,&quot;lat&quot;:&quot;37.74832&quot;,&quot;long&quot;:&quot;-122.402158&quot;,&quot;picurl&quot;:&quot;http://distilleryimage8.s3.amazonaws.com/98580826813011e2bbe622000a9f1270_7.jpg&quot;,&quot;hexcolor&quot;:&quot;#ECECEC&quot;,&quot;rowNumber&quot;:1}...]</code></pre>

  <h4>Hexcolor</h4>
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/hexcolors.png" alt="sheetsee"></p>
    <p>You must add a column to your spreadsheet with the heading <em>hexcolor</em> (case insensitive). The maps, charts and such use colors and this is the easiest way to standardize that. The color scheme is up to you, all you need to do is fill the column with hexidecimal color values. This <a href="http://color.hailpixel.com/">color picker</a> by <a href="https://twitter.com/hailpixel">Devin Hunt</a> is really nice. #Funtip: Coloring the background of the cell it&#39;s hexcolor brings delight! </p>

  <h4>Geocoding</h4>
    <p>If you intend to map your data and only have addresses you&#39;ll need to geocode the addresses into lat/long coordinates. Mapbox built a <a href="http://mapbox.com/tilemill/docs/guides/google-docs/#geocoding">plugin</a>
    that does this for you in Google Docs. You can also use websites like <a href="http://www.latlong.net/">latlong.net</a> to get the coordinates and paste them into rows with column headers <em>lat</em> and <em>long</em>.</p>
    <img src="https://raw.github.com/jllord/sheetsee-cache/master/img/latlong.png" alt="sheetsee">  
  <h4>Publishing Your Spreadsheet</h4>
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/publish.png" alt="sheetsee"></p>
    <p>You need to do this in order to generate a unique key for your spreadsheet, which Tabletop.js will use to get your spreadsheet data. In your Google Spreadsheet, click <em>File</em> &gt; <em>Publish to the Web</em>. Then in the next window click <em>Start Publishing</em>; it will then turn into a <em>Stop Publishing</em> button.</p>
    <p><img src="https://raw.github.com/jllord/sheetsee-cache/master/img/key.png" alt="sheetsee"></p>
    <p>You should have an address in a box at the bottom, your key is the portion between the = and the &amp;. You&#39;ll retrieve this later when you hook up your site to the spreadsheet.</p>
  <h3>Your Website</h3>
    <p>Before you get started with Sheetsee.js you should plan out your website. Design it, create the basic markup and stylesheet.</p>
    <p>For now, create empty <code data-language="javascript">div</code> placeholders for the map, chart and tables you plan on including.</p>
  <h2>Hooking Up Your Data</h2>
    <p>Here the paths diverge:</p>
  <h3>Client-side Hookup</h3>
    <p>For client-siders, all you need to do is include the depences and sheetsee in your HTML <code>&lt;head&gt;</code> and then in a script tag at the bottom of your page, right before the <code>&lt;/body&gt;</code> tag, you&#39;ll include this:</p>
<pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
    document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
        var gData
        var URL = &quot;0AvFUWxii39gXdFhqZzdTeU5DTWtOdENkQ1Y5bHdqT0E&quot;
        Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } ) 
    }) 
    function showInfo(data) {
        gData = data
        // 
        //everything you do with sheetsee goes here
        //
    }
&lt;/script&gt;</code></pre>
    <p>The <strong>URL</strong> variable is the key from your spreadsheet&#39;s longer URL, explained above. <code>Tabletop.init()</code> takes that URL and execute&#39;s Tabletop, when it&#39;s done generating the table it executes the callback <code>showInfo</code> function. It&#39;s inside of this function that you&#39;ll then use your spreadsheet data, <strong>gData</strong>, to do all the Sheetsee.js goodness with. </p>
  <h3>Server-side Hookup</h3>
    <p>The server-side version is in the repo <a href="http://www.github.com/jllord/sheetsee-cache">sheetsee-cache</a>. It uses <a href="http://www.nodejs.org">Node.js</a> to go to Google, get the spreadsheet data (with a Node.js version of <a href="http://npmjs.org/tabletop">Tabletop.js</a>, thanks Max Ogden!) and save it on the server. This means every user that visits the page doesn&#39;t have to wait on Google&#39;s response to load the charts from the data.</p>
    <p>When the server builds your page, it will build in your data as the variable gData. All you need to do is add your scripts to the bottom of the page. For the tables/templating you&#39;ll need to wrap them in an event listener so that it doesn&#39;t try and build them before the data has settled. </p>
<pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
    document.addEventListener(&#39;DOMContentLoaded&#39;, function() { 
        // table/templating things the rest can be in their own script tags if you&#39;d like
    }) 
&lt;/script&gt;</code></pre>
    <h4>Running Locally</h4>
      <p>You can run this locally and it will check your internet connection - if you&#39;re not online it will use the last saved data allowing you to develop offline, yay! </p>
      <p>Once you <a href="http://github.com/jlord/sheetsee-cache">clone the repo</a>, navigate there in Terminal, install the node modules and launch the server.</p>
<pre><code>cd sheetsee-cache
npm install 
node server.js</code></pre>
      <p>This will launch a local server you can visit and develop locally with in your browser. </p>
  <h2 id="workdata">Working With Your Data</h2>
    <p>Tabletop.js will return all of your data and it will be passed into your site as an <em>array of objects</em> called <strong>gData</strong>. Sheetsee.js has functions built in to help you filter or use that data in other ways if you&#39;d like.</p>
      <h4>Play Along!</h4>
        <p>This page is using sheetsee. If you (are in Chrome and) right click on the page and select <em>Inspect Element</em> it will bring up the Web Inspector. Select the <em>Console</em> tab. Now you can interact with the data and functions from Sheetsee. Give the functions below a try - <strong>gData</strong> is the variable with the data (from <a href="https://docs.google.com/spreadsheet/ccc?key=0AvFUWxii39gXdFhqZzdTeU5DTWtOdENkQ1Y5bHdqT0E&usp=sharing") target="_blank">this spreadsheet</a>).
        <img src="https://raw.github.com/jllord/sheetsee-cache/master/img/webconsole.png" alt="sheetsee"> 
    <h3 class="functionH">Sheetsee.getKeyword(data, keyword)</h3>
      <p>This takes in your data, an <em>array of objects</em>, and searches for a <em>string</em>, <strong>keyword</strong>, in each piece of your <strong>data</strong> (formerly the cells of your spreadsheet). It returns an array of each row that contained a keyword match. Similarly, using `getKeywordCount(data, keyword)` will return just the number of times the keyword occured.</p>
<pre><code data-language="javascript">getKeyword(gData, &quot;cat&quot;)
// returns [{breed: &quot;Fat&quot;, kind: &quot;cat&quot;, hexcolor: &quot;#CDCF83&quot;...}, {breed: &quot;Grey&quot;, kind: &quot;cat&quot;, hexcolor: &quot;#9C9B9A&quot;...}, {breed: &quot;Creepy&quot;, kind: &quot;cat&quot;, hexcolor: &quot;#918376&quot;...}]</code></pre>
    <h3 class="functionH">Sheetsee.getColumnTotal(data, column)</h3>
      <p>Given your <strong>data</strong>, an <em>array of objects</em> and a <em>string</em> <strong>column</strong> header, this functions sums each cell in that column, so they best be numbers.</p>
<pre><code data-language="javascript">getColumnTotal(gData, &quot;cuddlability&quot;)
// returns 11</code></pre>
    <h3 class="functionH">Sheetsee.getAveragefromColumn(data, column)</h3>
      <p>A really simple function that builds on <code data-language="javascript">getColumnTotal()</code> by returning the average number in a <strong>column</strong> of numbers.</p>
<pre><code data-language="javascript">getColumnAverage(gData, &quot;cuddlability&quot;)
// returns 1.8333333333333333</code></pre>
    <h3 class="functionH">Sheetsee.getMin(data, column)</h3>
      <p>This will return an <em>array</em> of <em>object</em> or <em>objects</em> (if there is a tie) of the element with the lowest number value in the <strong>column</strong> you specify from your <strong>data</strong>.</p>
<pre><code data-language="javascript">getMin(gData, &quot;cuddlability&quot;)
// returns [{breed: &quot;Fat&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#CDCF83&quot;...}, {breed: &quot;Grey&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#9C9B9A&quot;...}, {breed: &quot;Creepy&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#918376&quot;...}]</code></pre>

    <h3 class="functionH">Sheetsee.getMax(data, column)</h3>
      <p>This will return an <em>array</em> of <em>object</em> or <em>objects</em> (if there is a tie) of the element with the highest number value in the <strong>column</strong> you specify from your <strong>data</strong>.</p>
<pre><code data-language="javascript">getMax(gData, &quot;cuddlability&quot;)
// returns {breed: &quot;Teacup Maltese&quot;, cuddlability: &quot;5&quot;, hexcolor: &quot;#ECECEC&quot;, kind: &quot;Dog&quot;, lat: &quot;37.74832&quot;, long: &quot;-122.402158&quot;, name: &quot;Coco&quot;...}</code></pre>

  <div id="mostCuddle" class="ssExample container"></div>


    <h3>Don&#39;t Forget JavaScript Math</h3>
      <p>Create variables that are the sums, differences, multiples and so forth of others. Lots of info on that <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math">here on MDN</a>.</p>
<pre><code data-language="javascript">var profit09 = Sheetsee.getColumnTotal(gData, &quot;2009&quot;)
var profit10 = Sheetsee.getColumnTotal(gData, &quot;2010&quot;)
var difference = profit09 - profit10</code></pre>
        <h4>What These Little Bits are Good For</h4>
        <p>You don&#39;t have to just create tables of your data. You can have other portions of your page that show things like, &quot;The difference taco consumption between last week and this week is...&quot; These are easy to create with javascirpt math functions and knowing a little bit more about <a href="http://icanhazjs.com/">icanhas.js</a>. View source on this page to see how I created &quot;Most Cuddlable&quot;.</p>

    <h3 class="functionH">Sheetsee.getMatches(data, filter, category)</h3>
      <p>Takes <strong>data</strong> as an <em>array of objects</em>, a <em>string</em> you&#39;d like to <strong>filter</strong> and a <em>string</em> of the <strong>category</strong> you want it to look in (a column header from your spreadsheet).</p>
        <pre><code data-language="javascript">getMatches(gData, &quot;dog&quot;, &quot;kind&quot;)</code></pre>
          <p>Returns an <em>array of objects</em> matching the category&#39;s filter.</p>
<pre><code data-language="javascript">[{&quot;name&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;...}, {&quot;name&quot;: &quot;wolfgang&quot;, &quot;kind&quot;: &quot;dog&quot;...},{&quot;name&quot;: &quot;cooc&quot;, &quot;kind&quot;: &quot;dog&quot;...} ]</code></pre>

    <h3 class="functionH">Sheetsee.getOccurance(data, category)</h3>
      <p>Takes <strong>data</strong> as an <em>array of objects</em> and a <em>string</em> for <strong>category</strong> (a column header from your spreadsheet) you want tally how often an element occured.</p>
<pre><code data-language="javascript">getOccurance(gData, &quot;kind&quot;)</code></pre>
          <p>Returns an object with keys and values for each variation of the category and its occurance.</p>
<pre><code data-language="javascript">{&quot;dog&quot;: 3, &quot;cat&quot;: 3}</code></pre>

    <h3 class="functionH">Sheetsee.makeColorArrayOfObject(data, colors)</h3>
      <p>If you use <code data-language="javascript">getOccurance()</code> and want to then chart that data with d3.js, you&#39;ll need to make it into an <em>array</em> (instead of an object) and add colors back in (since the hexcolor column applies to the datapoints in your original dataset and not this new dataset).</p>
      <p>This function takes in your data, as an <em>object</em>, and an <em>array</em> of hexidecimal color strings which you define.</p>
<pre><code data-language="javascript">var kinds = getOccurance(gData, &quot;kind&quot;)
var kindColors = [&quot;#ff00ff&quot;, &quot;#DCF13C&quot;]
var kindData = makeColorArrayOfObjects(mostPopBreeds, kindColors)</code></pre>
      <p>It will return an array of objects formatted to go directly into a d3 chart with the appropriate <em>units</em> and <em>label keys</em>, like so:</p>
<pre><code data-language="javascript">[{&quot;label&quot;: &quot;dog&quot;, &quot;units&quot;: 2, &quot;hexcolor&quot;: &quot;#ff00ff&quot;}, {&quot;label&quot;: &quot;cat&quot;, &quot;units&quot;: 3, &quot;hexcolor&quot;: &quot;#DCF13C&quot;}]</code></pre>
      <p>If you pass in an array of just one color it will repeat that color for all items. If you pass fewer colors than data elements it will repeat the sequences of colors for the remainder elements.</p>

    <h3 class="functionH">Sheetsee.addUnitsLabels(arrayObj, oldLabel, oldUnits)</h3>
      <p>If you&#39;re using gData, the data directly from Tabletop, you&#39;ll need to format it before you use the d3 charts. You&#39;ll need to determine what part of your data you want to chart - what will be your label, what your charting, and what will be your units, how many of them are there (this should be a number).</p>
<pre><code data-language="javascript">var gData =  [{&quot;name&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;, &quot;cuddablity&quot;: 5}, {&quot;name&quot;: &quot;unagi&quot;, &quot;kind&quot;: &quot;cat&quot;, &quot;cuddlability&quot;: 0}]</code></pre>
    <p>For istance, if from our original data above we want to chart the age of each cat, we&#39;ll use:</p>
<pre><code data-language="javascript">Sheetsee.addUnitsLabels(gData, &quot;name&quot;, &quot;cuddlability&quot;)</code></pre>
    <p>Which will return an array, ready for the d3 charts:</p>
<pre><code data-language="javascript">[{&quot;label&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;, &quot;units&quot;: 5}, {&quot;label&quot;: &quot;unagi&quot;, &quot;kind&quot;: &quot;cat&quot;, &quot;units&quot;: 0}]</code></pre>

  <h2 id="makemap">Make a Map</h2>
    <div id="map" class="container"></div>
      <p>Sheetsee.js uses <a href="http://mapbox.com/mapbox.js">Mapbox.js</a>, a <a href="http://leafletjs.com/">Leaflet.js</a> plugin, to make maps.</p>
      <p>Create an empty <code data-language="javascript">&lt;div&gt;</code> in your HTML, with an id.</p>
<pre><code data-language="javascript">&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;</code></pre>
      <p>Next you&#39;ll need to create geoJSON out of your data so that it can be mapped.</p>

<h3 class="functionH">Sheetsee.createGeoJSON(data, optionsJSON)</h3>
  <p>This takes in your <strong>data</strong> and the parts of your data, <strong>optionsJSON</strong>,  that you plan in your map&#39;s popups. If you&#39;re not going to have popups on your markers, don&#39;t worry about it then and just pass in your data. </p>
<pre><code data-language="javascript">var optionsJSON = [&quot;name&quot;, &quot;breed&quot;, &quot;cuddlability&quot;]
var geoJSON = Sheetsee.createGeoJSON(gData, optionsJSON)</code></pre>
  <p>It will return an <em>array</em> in the special geoJSON format that map making things love. </p>
<pre><code data-language="javascript">[{
  &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [long, lat]},
  &quot;properties&quot;: {
    &quot;marker-size&quot;: &quot;small&quot;,
    &quot;marker-color&quot;: lineItem.hexcolor
  },
  &quot;opts&quot;: {the options you pass in},
}}</code></pre>

  <h3 class="functionH">Sheetsee.loadMap(mapDiv)</h3>
    <p>To create a simple map, with no data, you simply call `.loadMap() and pass in a <em>string</em> of the <strong>mapDiv</strong> (with no #) from your HTML.</p>
<pre><code data-language="javascript">var map = Sheetsee.loadMap(&quot;map&quot;)</code></pre>

  <h3 class="functionH">Sheetsee.addTileLayer(map, tileLayer)</h3>
    <p>To add a tile layer, aka a custom map scheme/design/background, you&#39;ll use this function which takes in your <strong>map</strong> and the source of the <strong>tileLayer</strong>. This source can be a Mapbox id, a URL to a TileJSON or your own generated TileJSON. See <a href="http://mapbox.com/mapbox.js/api/v1.0.2/#L.mapbox.tileLayer">Mapbox&#39;s Documentation</a> for more information.</p>
<pre><code data-language="javascript">Sheetsee.addTileLayer(map, &#39;examples.map-20v6611k&#39;)</code></pre>
    <p>You can add tiles from awesome mapmakers like <a href="examples.map-20v6611k">Stamen</a> or create your own in Mapbox&#39;s <a href="http://www.mapbox.com/tilemill">Tilemill</a> or <a href="https://tiles.mapbox.com/newmap#3.00/0.00/0.00">online</a>.</p>

  <h3 class="functionH">Sheetsee.addMarkerLayer(geoJSON, map)</h3>
    <p>To add makers to your map, use this function and pass in your <strong>geoJSON</strong> so that it can get the coordinates and your <strong>map</strong> so that it places the markers there.</p>
<pre><code data-language="javascript">var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map)</code></pre>

  <h3 class="functionH">Sheetsee.addPopups(map, markerLayer)</h3>
    <p>To customize the marker popup content in your map use this function and pass in your <strong>map</strong> and <strong>markerLayer</strong>.</p>
<pre><code data-language="javascript"> Sheetsee.addPopups(map, markerLayer)</code></pre>
    <p>To customize the marker popup content in your map you&#39;ll need to use this entire function on your website.</p>
<pre><code>function addPopups(map, markerLayer) {
  markerLayer.on(&#39;click&#39;, function(e) {
    var feature = e.layer.feature
    var popupContent = &#39;&lt;h2&gt;&#39; + feature.opts.name + &#39;&lt;/h2&gt;&#39; +
                        &#39;&lt;h3&gt;&#39; + feature.opts.breed + &#39;&lt;/h3&gt;&#39;
    e.layer.bindPopup(popupContent,{closeButton: false,})
  })
}</code></pre>
    <p>You will edit the <strong>popupContent</strong> variable however you&#39;d like your popups to look. To reference the data you sent to you geoJSON you&#39;ll use <code>feature.opts</code> and then one of the column headers you passed into <code>createGeoJSON().</code></p>

<h2 id="maketable">Make a Table</h2>

  <div class="container ssExample">
    <h3>Example - Local Pet Friends</h3>
    <input id="basicFilter" type="text" placeholder="filter by.."></input>
    <span id="basicClear" class="clear button">Clear</span>
    <span class="noMatches">no matches</span>
    <div id="basicTable" class="container"></div>
  </div>
  

  <p>Sheetsee.js supports making multiple tables or templates with IcanHas.js. The tables can have multiple inputs for searches and table headers can be used to sort the data in that column. For each of these you&#39;ll need a <code data-language="javascript">&lt;div&gt;</code> in your html, a <code data-language="javascript">&lt;script&gt;</code> template and a <code data-language="javascript">&lt;script&gt;</code> that calls table functions.</p>
    <h4>Your HTML Placeholder <code data-language="javascript">&lt;div&gt;</code></h4>
      <p>This is as simple as an empty <code data-language="javascript">&lt;div&gt;</code> with an id. This id should match the script tempate id in the next section.</p>
<pre><code data-language="javascript"> &lt;div id=&quot;siteTable&quot;&gt;&lt;/div&gt;</code></pre>
    <h4>Your <code data-language="javascript">&lt;script&gt;</code> Template</h4>
      <p>Your template is the mockup of what you&#39;d like your table to look like and what content it should show. Most of this is up to you but if you want users to be able to click on headers and sort that column you must make a table row with table headers with the class <em>tHeader</em>.</p>
      <p>The variables inside the {{}} must match the column headers in your spreadsheet. Lowercase (?) and remember spaces are ommited, so &quot;Place Name&quot; will become &quot;placename&quot;.</p>
<pre><code data-language="javascript">&lt;script id=&quot;siteTable&quot; type=&quot;text/html&quot;&gt;
    &lt;table&gt;
    &lt;tr&gt;&lt;th class=&quot;tHeader&quot;&gt;City&lt;/th&gt;&lt;th class=&quot;tHeader&quot;&gt;Place Name&lt;/th&gt;&lt;th class=&quot;tHeader&quot;&gt;Year&lt;/th&gt;&lt;th class=&quot;tHeader&quot;&gt;Image&lt;/th&gt;&lt;/tr&gt;
      {{#rows}}
        &lt;tr&gt;&lt;td&gt;{{city}}&lt;/td&gt;&lt;td&gt;{{placename}}&lt;/td&gt;&lt;td&gt;{{year}}&lt;/td&gt;&lt;td&gt;{{image}}&lt;/td&gt;&lt;/tr&gt;
      {{/rows}}
  &lt;/table&gt;
&lt;/script&gt;</code></pre>
<h4>Your <code data-language="javascript">&lt;script&gt;</code> Execution</h4>
<pre><code data-language="javascript">&lt;script type=&quot;text/javascript&quot;&gt;
    document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
        Sheetsee.makeTable(gData, &quot;#siteTable&quot;)
        Sheetsee.initiateTableFilter(gData, &quot;#tableFilter&quot;, &quot;#siteTable&quot;)
    })
&lt;/script&gt;</code></pre>
      <p>To create another table, simply repeat the steps with the corresponding data and divs.</p>
<pre><code data-language="javascript">&lt;div id=&quot;secondTable&quot;&gt;&lt;/div&gt;
&lt;script id=&quot;secondTable&quot;&gt; // your table template here &lt;/script&gt;
&lt;script&gt;
  Sheetsee.makeTable(otherData, &quot;#secondTable&quot;)
  Sheetsee.initiateTableFilter(otherData, &quot;#secondFilter&quot;, &quot;#secondTable&quot;)
&lt;/script&gt;
</code></pre>
      <p> Learn more about the things you can do with <a href="http://mustache.github.io/">mustache.js</a>.</p>

  <h3 class="functionH">Sheetsee.makeTable(data, targetDiv)</h3>
    <p>You&#39;ll call this to make a table out of a <strong>data</strong> and tell it what <strong>targetDiv</strong> in the html to render it in (this should also be the same id as your script template id).</p>
<pre><code data-language="javascript">Sheetsee.makeTable(gData, &quot;#siteTable&quot;)</code></pre>

<h2>Table Filter/Search</h2>
  <p>If you want to have an input to allow users to search/filter the data in the table, you&#39;ll add this to your html:</p>
<pre><code data-language="javascript">&lt;input id=&quot;tableFilter&quot; type=&quot;text&quot; placeholder=&quot;filter by..&quot;&gt;&lt;/input&gt;
&lt;span class=&quot;clear button&quot;&gt;Clear&lt;/span&gt;
&lt;span class=&quot;noMatches&quot;&gt;no matches&lt;/span&gt;</code></pre>

  <h3 class="functionH">Sheetsee.initiateTableFilter(data, filterDiv, tableDiv)</h3>
    <p>You will then call this function to make that input live:</p>
<pre><code data-language="javascript">Sheetsee.initiateTableFilter(gData, &quot;#TableFilter&quot;, &quot;#siteTable&quot;)</code></pre>

<h2 id="makechart">Make a Chart</h2>
  <p>Sheetsee.js comes with a d3.js bar, pie and line chart. Each requires your data be an <em>array of objects</em>, formatted to contain &quot;label&quot; and &quot;units&quot; keys. See the section above on Your Data to learn about formatting.</p>
  <p>You&#39;ll have to experiement with the charts to find the correct size your <code data-language="javascript">&lt;div&gt;</code> will need to be to hold the chart with your data in it nicely.</p>
  <p>You can also make your own d3 chart in a separate .js file, link to that and pass your data on to it. I&#39;d love to see people building some other charts that will work with Sheetsee.</p>

  <h3>Bar Chart</h3>

  <div class="ssExample container">
    <div id="dogBar"></div>
  </div>

    <p>To create a bar chart you&#39;ll need to add a placeholder <code data-language="javascript">&lt;div&gt;</code> in your HTML with an id.</p>
<pre><code data-language="javascript">&lt;div id=&quot;barChart&quot;&gt;&lt;/div&gt;</code></pre>
    <p>In your CSS, give it dimensions.</p>
<pre><code data-language="javascript">#barChart {height: 400px; max-width: 600px; background: #F8CDCD;}</code></pre>
    <p>In a <code data-language="javascript">&lt;script&gt;</code> tag set up your options.</p>
<pre><code data-language="javascript">var barOptions = {m: [60, 60, 30, 150], w: 600, h: 400, div: &quot;#barChart&quot;, xaxis: &quot;no. of pennies&quot;, hiColor: &quot;#FF317D&quot;}</code></pre>
      <ul>
        <li><strong>m</strong> is margins: top, right, bottom, left</li>
        <li><strong>w</strong> and <strong>h</strong> are width and height, this should match your CSS specs</li>
        <li><strong>div</strong> is the id for the <code data-language="javascript">&lt;div&gt;</code> in your HTML</li>
        <li><strong>xaxis</strong> is optional text label for your x axis</li>
        <li><strong>hiColor</strong> is the highlight color of your choosing!</li>
      </ul>
    <p>Then call the <code data-language="javascript">d3BarChart()</code> function with your <strong>data</strong> and <strong>options</strong>.</p>
<pre><code data-language="javascript">Sheetsee.d3BarChart(data, barOptions)</code></pre>

  <h3>Line Chart</h3>

  <div class="ssExample container">
    <div id="dogLine"></div>
  </div>

    <p>To create a line chart you&#39;ll need to add a placeholder <code data-language="javascript">&lt;div&gt;</code> in your html with an id.</p>
<pre><code data-language="javascript">&lt;div id=&quot;lineChart&quot;&gt;&lt;/div&gt;</code></pre>
    <p>In your CSS, give it dimensions.</p>
<pre><code data-language="javascript">#lineChart {height: 400px; max-width: 600px; background: #F8CDCD;}</code></pre>
    <p>In a <code data-language="javascript">&lt;script&gt;</code> tag set up your options.</p>
<pre><code data-language="javascript">var lineOptions = {m: [80, 100, 120, 100], w: 600, h: 400, div: &quot;#lineChart&quot;, yaxis: &quot;no. of pennies&quot;, hiColor: &quot;#14ECC8&quot;}</code></pre>
      <ul>
        <li><strong>m</strong> is your margins: top, right, bottom, left</li>
        <li><strong>w</strong> and <strong>h</strong> are width and height, this should match your CSS specs</li>
        <li><strong>div</strong> is the id for the <code data-language="javascript">&lt;div&gt;</code> in your HTML</li>
        <li><strong>yaxis</strong> is optional text label for your y axis</li>
        <li><strong>hiColor</strong> is the highlight color of your choosing!</li>
      </ul>
  <p>Then call the <code data-language="javascript">d3LineChart()</code> function with your <strong>data</strong> and <strong>options</strong>.</p>
<pre><code data-language="javascript">Sheetsee.d3LineChart(data, lineOptions)</code></pre>

  <h3>Pie Chart</h3>

  <div class="ssExample container">
    <div id="dogPie"></div>
  </div>

    <p>To create a bar chart you&#39;ll need to add a placeholder <code data-language="javascript">&lt;div&gt;</code> in your html with an id.</p>
<pre><code data-language="javascript">&lt;div id=&quot;pieChart&quot;&gt;&lt;/div&gt;</code></pre>
    <p>In your CSS, give it dimensions.</p>
<pre><code data-language="javascript">#pieChart {height: 400px; max-width: 600px; background: #F8CDCD;}</code></pre>
    <p>In a <code data-language="javascript">&lt;script&gt;</code> tag set up your options.</p>
<pre><code data-language="javascript">var pieOptions = {m: [80, 80, 80, 80], w: 600, h: 400, div: &quot;#pieChart&quot;, hiColor: &quot;#14ECC8&quot;}</code></pre>
      <ul>
        <li><strong>m</strong> is your margins: top, right, bottom, left</li>
        <li><strong>w</strong> and <strong>h</strong> are width and height, this should match your CSS specs</li>
        <li><strong>div</strong> is the id for the <code data-language="javascript">&lt;div&gt;</code> in your HTML</li>
        <li><strong>hiColor</strong> is the highlight color of your choosing!</li>
      </ul>
    <p>Then call the <code data-language="javascript">d3PieChart()</code> function with your <strong>data</strong> and <strong>options</strong>.</p>
<pre><code data-language="javascript">Sheetsee.d3PieChart(data, pieOptions)</code></pre>

<h2>Big Time Thanks</h2>
  <p>Thanks to <a href="http://www.codeforamerica.org">Code for America</a> for providing the platform me to build the first version of sheetsee.js for Macon, Georga.</p>
  <p>Thanks to <a href="http://www.twitter.com/dansinker">Dan Sinker</a> at <a href="http://www.mozillaopennews.org/">Open News</a> for having faith and getting things together to make this Code Sprint happen and thanks to <a href="https://twitter.com/whatsnewmedia">Matt Green</a> at WBEZ for being a willing partner.</p>
  <p>Thanks to <a href="http://www.twitter.com/maxogden">Max Ogden</a> for emotional support, teaching me JavaScript and working on the harder parts of Sheetsee.js - especially for making <a href="npmjs.org/tabletop">Tabletop.js for Node.js</a>.</p>
  <p>Thanks to all the authors and contributors to Tabletop.js, Mapbox.js, Leaflet.js, jQuery, ICanHas.js and d3.js. Thanks to Google and the Internet for existing and to all those who&#39;ve written tutorials or asked or answered a question on StackOverflow.</p>
  <p>Thanks to Mom and Dad for getting a computer in 1996 and the mIRC scripts I started writing that I suppose would eventually lead me here.</p>

  <h2>Licensed under <a href="https://github.com/jllord/sheetsee.js/blob/gh-pages/license.md" target="_blank">BSD</a>. East Bay represent!</h2>

<script id="basicTable" type="text/html">
  <table>
  <tr><th>Pic</th><th class="tHeader">Name</th><th class="tHeader">Breed</th><th class="tHeader">Kind</th><th class="tHeader">Cuddlability</th></tr>
    {{#rows}}
      <tr><td><img class="petThumbs" src="{{picurl}}"></td><td>{{name}}</td><td>{{breed}}</td><td>{{kind}}</td><td style="text-align: center;">{{cuddlability}}</td></tr>
    {{/rows}}
  </table>
</script>

<script id="mostCuddle" type="text/html">
  {{#rows}}
      <img class="most" src="{{picurl}}"></td>
      <h3>Winner, Most Cuddlable</h3>
      <ul style="list-style: none;">
        <li><span class="boxText">Name:</span> {{name}}</li>
        <li><span class="boxText">Breed:</span> {{breed}}</li>
        <li><span class="boxText">Cuddlability:</span> {{cuddlability}} / 5</li>
      </ul>
  {{/rows}}
</script>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    var gData
    var URL = "0AvFUWxii39gXdFhqZzdTeU5DTWtOdENkQ1Y5bHdqT0E"
    Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } ) 
  }) 
    
  function showInfo(data) {
    // window.tabletopData = tabletop 
    gData = data
    console.log("here is gData", gData)

    // make the map 
    var optionsJSON = ["picurl", "name", "cuddlability"]
    var geoJSON = Sheetsee.createGeoJSON(gData, optionsJSON)
    var map = Sheetsee.loadMap("map")
    Sheetsee.addTileLayer(map, 'examples.map-20v6611k')
    var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 11)
    // customize the popup content
    addPopups(map, markerLayer)
    function addPopups(map, markerLayer) {
      markerLayer.on('click', function(e) {
        var feature = e.layer.feature
        var popupContent = '<img class="petThumbs" src="' + feature.opts.picurl + '">' +
                            '<h3 style="text-align: center;">' + feature.opts.name + '</h3>'
        e.layer.bindPopup(popupContent,{closeButton: false,})
      })
    }

    // make a table
    Sheetsee.makeTable(gData, "#basicTable")
    Sheetsee.initiateTableFilter(gData, "#basicFilter", "#basicTable")

    // more icanhas for most cuddlable
    var mostCuddleIs = Sheetsee.getMax(gData, "cuddlability")
    var mostCuddle = ich.mostCuddle({
       rows: mostCuddleIs
    })
    $('#mostCuddle').html(mostCuddle)

    // make a bar chart
    // var barData = Sheetsee.addUnitsLabels(gData, "name", "cuddlability")
    var barOptions = {units: "cuddlability", labels: "name", m: [60, 150, 30, 150], w: 800, h: 300, div: "#dogBar", xaxis: "cuddlability", hiColor: "#EE0097"}
    Sheetsee.d3BarChart(gData, barOptions)
    // make a pie chart
    var dogKinds = Sheetsee.getOccurance(gData, "kind")
    var colors = ["#92F9FC", "#28C5CA", "#4B8E91"]
    var pieData = Sheetsee.makeColorArrayOfObject(dogKinds, colors)  
    var pieOptions = {units: "units", labels: "labels", m: [80, 80, 80, 80], w: 800, h: 400, div: "#dogPie", hiColor: "#E4EB29"}
    Sheetsee.d3PieChart(pieData, pieOptions)
    // make a line chart (uses same data as bar chart)
    var lineOptions = {units: "cuddlability", labels: "name", m: [80, 100, 120, 100], w: 800, h: 400, div: "#dogLine", yaxis: "cuddlability", hiColor: "#E4EB29"}
    Sheetsee.d3LineChart(gData, lineOptions)
  }
</script>

</body>
</html>